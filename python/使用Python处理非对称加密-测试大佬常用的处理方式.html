<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='ç”µè„‘,ç”µè„‘è®²è§£,ç”µè„‘æŠ€æœ¯,ç¼–ç¨‹,ç”µè„‘æ•…éšœç»´ä¿®ä½¿ç”¨Pythonå¤„ç†éå¯¹ç§°åŠ å¯†-æµ‹è¯•å¤§ä½¬å¸¸ç”¨çš„å¤„ç†æ–¹å¼' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>é¦–é¡µ</a></li>
</div><div onclick='hidden1()' >åˆ†äº«</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>ä½¿ç”¨Pythonå¤„ç†éå¯¹ç§°åŠ å¯†-æµ‹è¯•å¤§ä½¬å¸¸ç”¨çš„å¤„ç†æ–¹å¼</center></div><div class='banquan'>åŸæ–‡å‡ºå¤„:æœ¬æ–‡ç”±åšå®¢å›­åšä¸»å¯ä¼˜æä¾›ã€‚<br/>
åŸæ–‡è¿æ¥:https://www.cnblogs.com/keyou1/p/12071897.html</div><br>
    <h3 id="ä¸€æ€è€ƒ">ä¸€ã€æ€è€ƒâ“â”</h3>
<h4 id="ä»€ä¹ˆæ˜¯éå¯¹ç§°åŠ å¯†"><span style="color:rgb(230,3,130);font-size: 20px">1.ä»€ä¹ˆæ˜¯éå¯¹ç§°åŠ å¯†?</span></h4>
<p><img src="./images/ä½¿ç”¨Pythonå¤„ç†éå¯¹ç§°åŠ å¯†-æµ‹è¯•å¤§ä½¬å¸¸ç”¨çš„å¤„ç†æ–¹å¼0.png" /></p>
<ul>
<li>å…¬é’¥åŠ å¯†ç³»ç»Ÿï¼Œå¹¿æ³›ç”¨äºæ•°æ®åŠ å¯†ä¼ è¾“</li>
<li>æ›´è¯¦ç»†çš„è§£é‡Šå¯å‚è€ƒç»´åŸºç™¾ç§‘ï¼ˆ https://en.wikipedia.org/wiki/RSA_(cryptosystem) ï¼‰</li>
</ul>
<p><br /></p>
<h4 id="éå¯¹ç§°åŠ å¯†éš¾å—"><span style="color:rgb(230,3,130);font-size: 20px">2.éå¯¹ç§°åŠ å¯†éš¾å—?</span></h4>
<p><img src="./images/ä½¿ç”¨Pythonå¤„ç†éå¯¹ç§°åŠ å¯†-æµ‹è¯•å¤§ä½¬å¸¸ç”¨çš„å¤„ç†æ–¹å¼1.png" /></p>
<ul>
<li>very easy!</li>
<li>å‡ ä¹æ¯ä¸€ç§å¼€å‘è¯­è¨€éƒ½èƒ½å¤„ç†ï¼ŒåŒæ—¶ä¹Ÿå­˜åœ¨å¤§é‡çš„å·¥å…·</li>
<li>Pythonä¸­è¦è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼Œä½¿ç”¨rsaæ¨¡å—å¯ä»¥å¤§å¤§ç®€åŒ–åŠ å¯†å¤„ç†è¿‡ç¨‹</li>
</ul>
<p><br /></p>
<p><br /></p>
<h3 id="äºŒåŸºæœ¬æ“ä½œ">äºŒã€åŸºæœ¬æ“ä½œğŸ”¨ğŸ”¨</h3>
<p><img src="./images/ä½¿ç”¨Pythonå¤„ç†éå¯¹ç§°åŠ å¯†-æµ‹è¯•å¤§ä½¬å¸¸ç”¨çš„å¤„ç†æ–¹å¼2.png" /></p>
<h4 id="å®‰è£…rsa"><span style="color:rgb(230,3,130);font-size: 20px">1.å®‰è£…rsa</span></h4>
<ul>
<li><p>æ”¯æŒpython 2.7 æˆ–è€… python 3.5 ä»¥ä¸Šç‰ˆæœ¬</p></li>
<li><p>ä½¿ç”¨è±†ç“£pypiæºæ¥å®‰è£…rsa</p></li>
</ul>
<pre><code><code>pip install -i https://pypi.douban.com/simple rsa</code></pre>
<p><br /></p>
<h4 id="ç”Ÿæˆå…¬ç§é’¥å¯¹"><span style="color:rgb(230,3,130);font-size: 20px">2.ç”Ÿæˆå…¬ç§é’¥å¯¹</span></h4>
<p><img src="./images/ä½¿ç”¨Pythonå¤„ç†éå¯¹ç§°åŠ å¯†-æµ‹è¯•å¤§ä½¬å¸¸ç”¨çš„å¤„ç†æ–¹å¼3.png" /></p>
<pre><code><code>import rsa

# ä¸€ã€ç”Ÿæˆ512ä½çš„å…¬ç§é’¥å¯¹
# a. lemon_pubä¸ºPublicKeyå¯¹è±¡, lemon_privä¸ºPrivateKeyå¯¹è±¡
# b. 512ä¸ºç§˜é’¥çš„ä½æ•°, å¯ä»¥è‡ªå®šä¹‰æŒ‡å®š, ä¾‹å¦‚: 128ã€256ã€512ã€1024ã€2048ç­‰
lemon_pub, lemon_priv = rsa.newkeys(512)
print(lemon_pub)
print(lemon_priv)</code></pre>
<p><br /></p>
<h4 id="åŠ å¯†è§£å¯†"><span style="color:rgb(230,3,130);font-size: 20px">3.åŠ å¯†è§£å¯†</span></h4>
<pre><code><code>import rsa

# 1ã€æ¥æ”¶è€…(æŸ æª¬å°å§å§)ç”Ÿæˆ512ä½å…¬ç§é’¥å¯¹
# a. lemon_pubä¸ºPublicKeyå¯¹è±¡, lemon_privä¸ºPrivateKeyå¯¹è±¡
# b. 512ä¸ºç§˜é’¥çš„ä½æ•°, å¯ä»¥è‡ªå®šä¹‰æŒ‡å®š, ä¾‹å¦‚: 128ã€256ã€512ã€1024ã€2048ç­‰
lemon_pub, lemon_priv = rsa.newkeys(512)

# 2ã€å‘é€è€…(å¯ä¼˜)ä½¿ç”¨æ¥æ”¶è€…(æŸ æª¬å°å§å§)çš„å…¬é’¥å»åŠ å¯†æ¶ˆæ¯
# rsaåªèƒ½å¤„ç†å­—èŠ‚ç±»å‹, æ•…å­—ç¬¦ä¸²ç±»å‹éœ€è¦è½¬åŒ–ä¸ºå­—èŠ‚ç±»å‹
love_talk = &quot;Lemon little girl, I love you very much!&quot;.encode(&quot;utf-8&quot;)
cryto_info = rsa.encrypt(love_talk, lemon_pub)    # ä½¿ç”¨æ¥æ”¶è€…(æŸ æª¬å°å§å§)çš„å…¬é’¥åŠ å¯†

# 3. æ¥æ”¶è€…(æŸ æª¬å°å§å§)ä½¿ç”¨è‡ªå·±çš„ç§é’¥å»è§£å¯†æ¶ˆæ¯
talk_real = rsa.decrypt(cryto_info, lemon_priv)
talk_real = talk_real.decode(&quot;utf-8&quot;)
print(talk_real)
</code></pre>
<p><br /></p>
<h3 id="ä¸‰è¿›é˜¶æ“ä½œ">ä¸‰ã€è¿›é˜¶æ“ä½œğŸ’ªğŸ½ğŸ’ªğŸ½</h3>
<p><img src="./images/ä½¿ç”¨Pythonå¤„ç†éå¯¹ç§°åŠ å¯†-æµ‹è¯•å¤§ä½¬å¸¸ç”¨çš„å¤„ç†æ–¹å¼4.png" /></p>
<h4 id="å¯¹åŠ å¯†è¿‡ç¨‹è¿›è¡Œå°è£…">1.å¯¹åŠ å¯†è¿‡ç¨‹è¿›è¡Œå°è£…</h4>
<pre><code><code># å¯¼å…¥base64æ¨¡å—æ¥è¿›è¡Œbase64ç¼–ç 
import base64

import rsa


class HandleSign:
    # å®šä¹‰æœåŠ¡å™¨å…¬é’¥, å¾€å¾€å¯ä»¥å­˜æ”¾åœ¨å…¬é’¥æ–‡ä»¶ä¸­
    server_pub = &quot;&quot;&quot;
        -----BEGIN PUBLIC KEY-----
        MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDQENQujkLfZfc5Tu9Z1LprzedE
        O3F7gs+7bzrgPsMl29LemonPYvIG8C604CprLittlenJpnhWu2lGirlWZyLq6sBr
        tuPorOc42+gInFfyhJAwdZB6Sqlove7bW+jNe5youDtU7very6Gx+muchGo8Dg+S
        kKlZFc8Br7SHtbL2tQIDAQAB
        -----END PUBLIC KEY-----
        &quot;&quot;&quot;

    @classmethod
    def to_encrypt(cls, msg, pub_key=None):
        &quot;&quot;&quot;
        éå¯¹ç§°åŠ å¯†
        :param msg: å¾…åŠ å¯†å­—ç¬¦ä¸²æˆ–è€…å­—èŠ‚
        :param pub_key: å…¬é’¥
        :return: base64å¯†æ–‡å­—ç¬¦ä¸²
        &quot;&quot;&quot;
        if isinstance(msg, str):            # å¦‚æœmsgä¸ºå­—ç¬¦ä¸², åˆ™è½¬åŒ–ä¸ºå­—èŠ‚ç±»å‹
            msg = msg.encode(&#39;utf-8&#39;)
        elif isinstance(msg, bytes):        # å¦‚æœmsgä¸ºå­—èŠ‚ç±»å‹, åˆ™æ— éœ€å¤„ç†
            pass
        else:                               # å¦åˆ™æŠ›å‡ºå¼‚å¸¸
            raise TypeError(&#39;msgå¿…é¡»ä¸ºå­—ç¬¦ä¸²æˆ–è€…å­—èŠ‚ç±»å‹!&#39;)

        if not pub_key:                     # å¦‚æœpub_keyä¸ºç©º, åˆ™ä½¿ç”¨å…¨å±€å…¬é’¥
            pub_key = cls.server_pub.encode(&quot;utf-8&quot;)
        elif isinstance(pub_key, str):      # å¦‚æœpub_keyä¸ºå­—ç¬¦ä¸², åˆ™è½¬åŒ–ä¸ºå­—èŠ‚ç±»å‹
            pub_key = pub_key.encode(&#39;utf-8&#39;)
        elif isinstance(pub_key, bytes):    # å¦‚æœmsgä¸ºå­—èŠ‚ç±»å‹, åˆ™æ— éœ€å¤„ç†
            pass
        else:                               # å¦åˆ™æŠ›å‡ºå¼‚å¸¸
            raise TypeError(&#39;pub_keyå¿…é¡»ä¸ºNoneã€å­—ç¬¦ä¸²æˆ–è€…å­—èŠ‚ç±»å‹!&#39;)

        public_key_obj = rsa.PublicKey.load_pkcs1_openssl_pem(pub_key)  # åˆ›å»º PublicKey å¯¹è±¡

        cryto_msg = rsa.encrypt(msg, public_key_obj)  # ç”ŸæˆåŠ å¯†æ–‡æœ¬
        cipher_base64 = base64.b64encode(cryto_msg)   # å°†åŠ å¯†æ–‡æœ¬è½¬åŒ–ä¸º base64 ç¼–ç 

        return cipher_base64.decode()   # å°†å­—èŠ‚ç±»å‹çš„ base64 ç¼–ç è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ç±»å‹


if __name__ == &#39;__main__&#39;:
    # å¾…åŠ å¯†å­—ç¬¦ä¸²æˆ–è€…å­—èŠ‚
    love_talk = &quot;Lemon little girl, I love you very much!&quot;

    # è°ƒç”¨to_encryptç±»æ–¹æ³•æ¥è¿›è¡ŒåŠ å¯†
    cryto_info = HandleSign.to_encrypt(love_talk)
    print(cryto_info)
</code></pre>
<p><br /></p>
<p><br /></p>
<h3 id="å››æ€»ç»“">å››ã€æ€»ç»“ğŸ’¡ğŸ’¡</h3>
<p><img src="./images/ä½¿ç”¨Pythonå¤„ç†éå¯¹ç§°åŠ å¯†-æµ‹è¯•å¤§ä½¬å¸¸ç”¨çš„å¤„ç†æ–¹å¼5.png" /></p>
<ul>
<li>æœ¬æ–‡ä»‹ç»äº†Pythonä¸­ä½¿ç”¨rsaæ¨¡å—è¿›è¡Œéå¯¹ç§°åŠ å¯†çš„ç›¸å…³æ“ä½œ</li>
<li>å¯¹äºä½¿ç”¨Pythonè¿›è¡Œéå¯¹ç§°åŠ å¯†æœ‰å¸®åŠ©</li>
<li>æœ¬æ–‡ä¸ºå¯ä¼˜åŸåˆ›, å¦‚éœ€è½¬è½½è¯·è”ç³»æœ¬äººã€‚æœ‰ä¸è¶³ä¹‹å¤„, æ¬¢è¿æŒ‡ç‚¹!</li>
</ul>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>